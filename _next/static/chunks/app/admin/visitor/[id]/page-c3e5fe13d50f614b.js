(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8763],{255:(e,r,s)=>{"use strict";function t(e){let{moduleIds:r}=e;return null}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"PreloadChunks",{enumerable:!0,get:function(){return t}}),s(5155),s(7650),s(5744),s(589)},2146:(e,r,s)=>{"use strict";function t(e){let{reason:r,children:s}=e;return s}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BailoutToCSR",{enumerable:!0,get:function(){return t}}),s(5262)},4054:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var s in r)Object.defineProperty(e,s,{enumerable:!0,get:r[s]})}(r,{bindSnapshot:function(){return l},createAsyncLocalStorage:function(){return a},createSnapshot:function(){return i}});let s=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class t{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}static bind(e){return e}}let n="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function a(){return n?new n:new t}function l(e){return n?n.bind(e):t.bind(e)}function i(){return n?n.snapshot():function(e,...r){return e(...r)}}},4126:(e,r,s)=>{"use strict";s.d(r,{AdminProvider:()=>u,P:()=>m,z:()=>c});var t=s(5155),n=s(2115),a=s(5695),l=s(6104),i=s(283),d=s(9599);let o=(0,n.createContext)({isAdmin:!1,adminLoading:!0,adminUser:null}),c=()=>(0,n.useContext)(o),u=e=>{let{children:r}=e,{currentUser:s,loading:c,userRole:u}=(0,i.A)(),[m,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!0),[j,y]=(0,n.useState)(null);return(0,a.useRouter)(),(0,n.useEffect)(()=>{(async()=>{if(!c){if(!s){x(!1),y(null),p(!1);return}try{let e=(0,d.Mu)(u);e||(e=await (0,l._x)(s.uid)),x(e),y(e?s:null)}catch(e){console.error("Error checking admin status:",e),x(!1),y(null)}finally{p(!1)}}})()},[s,c,u]),(0,t.jsx)(o.Provider,{value:{isAdmin:m,adminLoading:h,adminUser:j},children:r})},m=e=>function(r){let{isAdmin:s,adminLoading:l}=c(),i=(0,a.useRouter)();return((0,n.useEffect)(()=>{l||s||i.push("/admin/login")},[s,l,i]),l)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Checking admin credentials..."}),(0,t.jsx)("p",{className:"text-gray-400",children:"Please wait while we verify your access."})]})}):s?(0,t.jsx)(e,{...r}):null}},5028:(e,r,s)=>{"use strict";s.d(r,{default:()=>n.a});var t=s(6645),n=s.n(t)},5695:(e,r,s)=>{"use strict";var t=s(8999);s.o(t,"useParams")&&s.d(r,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},5744:(e,r,s)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"workAsyncStorage",{enumerable:!0,get:function(){return t.workAsyncStorageInstance}});let t=s(7828)},6645:(e,r,s)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return n}});let t=s(8229)._(s(7357));function n(e,r){var s;let n={};"function"==typeof e&&(n.loader=e);let a={...n,...r};return(0,t.default)({...a,modules:null==(s=a.loadableGenerated)?void 0:s.modules})}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},7357:(e,r,s)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return d}});let t=s(5155),n=s(2115),a=s(2146);function l(e){return{default:e&&"default"in e?e.default:e}}s(255);let i={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},d=function(e){let r={...i,...e},s=(0,n.lazy)(()=>r.loader().then(l)),d=r.loading;function o(e){let l=d?(0,t.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=!r.ssr||!!r.loading,o=i?n.Suspense:n.Fragment,c=r.ssr?(0,t.jsxs)(t.Fragment,{children:[null,(0,t.jsx)(s,{...e})]}):(0,t.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,t.jsx)(s,{...e})});return(0,t.jsx)(o,{...i?{fallback:l}:{},children:c})}return o.displayName="LoadableComponent",o}},7695:(e,r,s)=>{Promise.resolve().then(s.bind(s,8688))},7828:(e,r,s)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"workAsyncStorageInstance",{enumerable:!0,get:function(){return t}});let t=(0,s(4054).createAsyncLocalStorage)()},8688:(e,r,s)=>{"use strict";s.d(r,{default:()=>h});var t=s(5155),n=s(2115),a=s(283),l=s(5695),i=s(6104),d=s(1115),o=s(6874),c=s.n(o),u=s(5028),m=s(4126);let x=(0,u.default)(()=>Promise.all([s.e(9484),s.e(2340)]).then(s.bind(s,2340)),{loadableGenerated:{webpack:()=>[2340]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"h-64 bg-gray-700 flex items-center justify-center",children:"Loading map..."})}),h=(0,m.P)(function(){var e,r,s,o,u,m;let{currentUser:h}=(0,a.A)();(0,l.useRouter)();let p=(0,l.useParams)().id,[j,y]=(0,n.useState)(null),[b,f]=(0,n.useState)(!0),[N,g]=(0,n.useState)(null);if((0,n.useEffect)(()=>{(async()=>{if(!h){g("You must be logged in to view visitor details"),f(!1);return}if(!p){g("No visitor ID provided"),f(!1);return}try{if(!i.v$)throw Error("Firebase Realtime Database is not initialized");let e=(0,d.KR)(i.v$,"analytics/visitors/".concat(p)),r=await (0,d.Jt)(e);r.exists()?y(r.val()):g("Visitor not found"),f(!1)}catch(e){console.error("Error fetching visitor data:",e),g("Failed to load visitor data"),f(!1)}})()},[h,p]),b)return(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Visitor Details"}),(0,t.jsx)("p",{children:"Loading visitor data..."})]});if(N)return(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Visitor Details"}),(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,t.jsx)("p",{children:N})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(c(),{href:"/admin/analytics",className:"text-blue-500 hover:underline",children:"Back to Analytics"})})]});if(!j)return(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Visitor Details"}),(0,t.jsx)("p",{children:"No visitor data found"}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(c(),{href:"/admin/analytics",className:"text-blue-500 hover:underline",children:"Back to Analytics"})})]});let v=j.timestamp?new Date(j.timestamp).toLocaleString():"Unknown";return(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Visitor Details"}),(0,t.jsx)(c(),{href:"/admin/analytics",className:"text-blue-500 hover:underline",children:"Back to Analytics"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Basic Information"}),(0,t.jsx)("table",{className:"min-w-full",children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Session ID"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.sessionId})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Timestamp"}),(0,t.jsx)("td",{className:"py-2 px-4",children:v})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Local Time"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.localTime||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Page"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.page})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Referrer"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.referrer||"Direct"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Language"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.language})]})]})})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Browser Information"}),(0,t.jsx)("table",{className:"min-w-full",children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Browser"}),(0,t.jsxs)("td",{className:"py-2 px-4",children:[null==(e=j.browserInfo)?void 0:e.browser," ",null==(r=j.browserInfo)?void 0:r.version]})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Operating System"}),(0,t.jsx)("td",{className:"py-2 px-4",children:null==(s=j.browserInfo)?void 0:s.os})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Device Type"}),(0,t.jsx)("td",{className:"py-2 px-4",children:(null==(o=j.browserInfo)?void 0:o.mobile)?"Mobile":"Desktop"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Screen Size"}),(0,t.jsxs)("td",{className:"py-2 px-4",children:[null==(u=j.screenSize)?void 0:u.width," x ",null==(m=j.screenSize)?void 0:m.height]})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"User Agent"}),(0,t.jsx)("td",{className:"py-2 px-4 text-xs break-all",children:j.userAgent})]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Location Information"}),j.location?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,t.jsx)("table",{className:"min-w-full",children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Country"}),(0,t.jsxs)("td",{className:"py-2 px-4",children:[j.location.country,j.location.countryCode&&" (".concat(j.location.countryCode,")")]})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Region"}),(0,t.jsxs)("td",{className:"py-2 px-4",children:[j.location.region,j.location.regionCode&&" (".concat(j.location.regionCode,")")]})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"City"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.city||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"District"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.district||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Ward"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.ward||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Street"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.street||"Unknown"})]})]})}),(0,t.jsx)("table",{className:"min-w-full",children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Postal Code"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.postalCode||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Formatted Address"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.formattedAddress||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Timezone"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.timezone||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"ISP"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.isp||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Connection Type"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.connectionType||"Unknown"})]}),(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4 font-medium",children:"Coordinates"}),(0,t.jsx)("td",{className:"py-2 px-4",children:j.location.latitude&&j.location.longitude?(0,t.jsxs)("a",{href:"https://www.google.com/maps?q=".concat(j.location.latitude,",").concat(j.location.longitude),target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:[j.location.latitude,", ",j.location.longitude]}):"Unknown"})]})]})})]}),j.location.latitude&&j.location.longitude&&(0,t.jsxs)("div",{className:"mt-4 rounded overflow-hidden",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Map Location"}),(0,t.jsx)(x,{latitude:j.location.latitude,longitude:j.location.longitude,popupContent:j.location.formattedAddress||"".concat(j.location.city||"",", ").concat(j.location.region||"",", ").concat(j.location.country||""),height:"400px"})]})]}):(0,t.jsx)("p",{className:"text-gray-400",children:"No location data available"})]}),j.queryParams&&Object.keys(j.queryParams).length>0&&(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Query Parameters"}),(0,t.jsxs)("table",{className:"min-w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left py-2 px-4",children:"Parameter"}),(0,t.jsx)("th",{className:"text-left py-2 px-4",children:"Value"})]})}),(0,t.jsx)("tbody",{children:Object.entries(j.queryParams).map(e=>{let[r,s]=e;return(0,t.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:r}),(0,t.jsx)("td",{className:"py-2 px-4",children:s})]},r)})})]})]})]})})},9599:(e,r,s)=>{"use strict";s.d(r,{Mu:()=>a,cb:()=>l});let t={viewer:0,guest:0,user:1,editor:2,moderator:3,admin:4,superadmin:5},n=(e,r)=>(t.hasOwnProperty(e)||(e="guest"),t.hasOwnProperty(r)||(r="guest"),t[e]>=t[r]),a=e=>n(e,"admin"),l=e=>({viewer:"Người xem",guest:"Kh\xe1ch",user:"Người d\xf9ng đ\xe3 đăng k\xfd",editor:"Bi\xean tập vi\xean",moderator:"Quản trị vi\xean nội dung",admin:"Quản trị vi\xean",superadmin:"Quản trị vi\xean cấp cao"})[e]||e}},e=>{var r=r=>e(e.s=r);e.O(0,[2992,9507,7158,6874,883,283,8441,1684,7358],()=>r(7695)),_N_E=e.O()}]);