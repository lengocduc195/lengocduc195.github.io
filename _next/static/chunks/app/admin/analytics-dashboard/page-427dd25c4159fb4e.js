(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8532],{255:(e,t,s)=>{"use strict";function a(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return a}}),s(5155),s(7650),s(5744),s(589)},2146:(e,t,s)=>{"use strict";function a(e){let{reason:t,children:s}=e;return s}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),s(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{bindSnapshot:function(){return l},createAsyncLocalStorage:function(){return i},createSnapshot:function(){return n}});let s=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}static bind(e){return e}}let r="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function i(){return r?new r:new a}function l(e){return r?r.bind(e):a.bind(e)}function n(){return r?r.snapshot():function(e,...t){return e(...t)}}},4126:(e,t,s)=>{"use strict";s.d(t,{AdminProvider:()=>x,P:()=>h,z:()=>d});var a=s(5155),r=s(2115),i=s(5695),l=s(6104),n=s(283),o=s(9599);let c=(0,r.createContext)({isAdmin:!1,adminLoading:!0,adminUser:null}),d=()=>(0,r.useContext)(c),x=e=>{let{children:t}=e,{currentUser:s,loading:d,userRole:x}=(0,n.A)(),[h,g]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!0),[p,y]=(0,r.useState)(null);return(0,i.useRouter)(),(0,r.useEffect)(()=>{(async()=>{if(!d){if(!s){g(!1),y(null),u(!1);return}try{let e=(0,o.Mu)(x);e||(e=await (0,l._x)(s.uid)),g(e),y(e?s:null)}catch(e){console.error("Error checking admin status:",e),g(!1),y(null)}finally{u(!1)}}})()},[s,d,x]),(0,a.jsx)(c.Provider,{value:{isAdmin:h,adminLoading:m,adminUser:p},children:t})},h=e=>function(t){let{isAdmin:s,adminLoading:l}=d(),n=(0,i.useRouter)();return((0,r.useEffect)(()=>{l||s||n.push("/admin/login")},[s,l,n]),l)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Checking admin credentials..."}),(0,a.jsx)("p",{className:"text-gray-400",children:"Please wait while we verify your access."})]})}):s?(0,a.jsx)(e,{...t}):null}},5028:(e,t,s)=>{"use strict";s.d(t,{default:()=>r.a});var a=s(6645),r=s.n(a)},5095:(e,t,s)=>{Promise.resolve().then(s.bind(s,9998))},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5744:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=s(7828)},6645:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let a=s(8229)._(s(7357));function r(e,t){var s;let r={};"function"==typeof e&&(r.loader=e);let i={...r,...t};return(0,a.default)({...i,modules:null==(s=i.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let a=s(5155),r=s(2115),i=s(2146);function l(e){return{default:e&&"default"in e?e.default:e}}s(255);let n={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},o=function(e){let t={...n,...e},s=(0,r.lazy)(()=>t.loader().then(l)),o=t.loading;function c(e){let l=o?(0,a.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,n=!t.ssr||!!t.loading,c=n?r.Suspense:r.Fragment,d=t.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(s,{...e})]}):(0,a.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(s,{...e})});return(0,a.jsx)(c,{...n?{fallback:l}:{},children:d})}return c.displayName="LoadableComponent",c}},7828:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,s(4054).createAsyncLocalStorage)()},9599:(e,t,s)=>{"use strict";s.d(t,{Mu:()=>i,cb:()=>l});let a={viewer:0,guest:0,user:1,editor:2,moderator:3,admin:4,superadmin:5},r=(e,t)=>(a.hasOwnProperty(e)||(e="guest"),a.hasOwnProperty(t)||(t="guest"),a[e]>=a[t]),i=e=>r(e,"admin"),l=e=>({viewer:"Người xem",guest:"Kh\xe1ch",user:"Người d\xf9ng đ\xe3 đăng k\xfd",editor:"Bi\xean tập vi\xean",moderator:"Quản trị vi\xean nội dung",admin:"Quản trị vi\xean",superadmin:"Quản trị vi\xean cấp cao"})[e]||e},9850:(e,t,s)=>{"use strict";s.d(t,{Xg:()=>i});var a=s(6104),r=s(1115);let i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(!a.v$)return console.error("Firebase Realtime Database is not initialized"),[];try{let t=(0,r.KR)(a.v$,"analytics/visitors"),s=(0,r.P)(t,(0,r.kT)("timestamp"),(0,r.$1)(e)),i=await (0,r.Jt)(s);if(i.exists()){let e=[];return i.forEach(t=>{e.push({...t.val(),id:t.key})}),e.reverse()}return[]}catch(e){return console.error("Error getting recent visitors:",e),[]}}},9998:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),r=s(2115),i=s(283),l=s(6104),n=s(1115),o=s(4126),c=s(6874),d=s.n(c),x=s(5028),h=s(9850);let g=(0,x.default)(()=>Promise.all([s.e(7776),s.e(8699)]).then(s.bind(s,8699)),{loadableGenerated:{webpack:()=>[8699]},ssr:!1}),m=(0,o.P)(function(){let{currentUser:e}=(0,i.A)(),[t,s]=(0,r.useState)("overview"),[o,c]=(0,r.useState)("last30days"),[x,m]=(0,r.useState)(new Date(Date.now()-2592e6).toISOString().split("T")[0]),[u,p]=(0,r.useState)(new Date().toISOString().split("T")[0]),[y,b]=(0,r.useState)(!0),[j,f]=(0,r.useState)(null),[v,N]=(0,r.useState)("all"),[w,P]=(0,r.useState)({totalVisitors:0,totalPageViews:0,uniqueVisitors:0,countries:0,cities:0,totalUsers:0,registeredUsers:0,anonymousVisitors:0,usersByRole:{},topPages:{},topCountries:{},topCities:{},recentVisitors:[]}),[k,S]=(0,r.useState)({totalVisitors:0,uniqueVisitors:0,registeredUsers:0,anonymousVisitors:0,totalPageViews:0,averagePageViewsPerVisitor:0,topPages:[],averageTimeOnSite:0,averageTimePerPage:0,bounceRate:0,deviceTypes:{},browsers:{},operatingSystems:{},countries:{},regions:{},cities:{},totalInteractions:0,interactionsByType:{},visitorsByHour:Array(24).fill(0),visitorsByDay:Array(7).fill(0),visitorsByMonth:Array(12).fill(0),referrers:{},isLoading:!0}),[T,O]=(0,r.useState)({country:{},region:{},city:{},district:{},ward:{},street:{},postalCode:{},timezone:{},isp:{},connectionType:{}}),[V,C]=(0,r.useState)([]),[A,_]=(0,r.useState)({}),I=e=>{let t=Math.floor(e/60),s=Math.floor(e%60);return"".concat(t,"m ").concat(s,"s")},L=e=>Object.fromEntries(Object.entries(e).sort((e,t)=>t[1]-e[1])),E=e=>{let{items:t}=e;return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-400 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:e.value})]},t))})},R=e=>{let{visitors:t,showDetails:s=!0,itemsPerPage:i=10}=e,[l,n]=(0,r.useState)(1),o=Math.ceil(t.length/i),c=l*i,x=t.slice(c-i,c),h=e=>n(e);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Time"}),s&&(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Local Time"}),(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Page"}),(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Location"}),(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Browser"}),s&&(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"OS"}),(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Device"}),s&&(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Referrer"}),!s&&(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:x.map((e,t)=>{var r,i,l,n;return(0,a.jsxs)("tr",{className:t%2==0?"bg-gray-750":"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"py-2 px-4",children:e.timestamp?new Date(e.timestamp).toLocaleString():"Unknown"}),s&&(0,a.jsx)("td",{className:"py-2 px-4",children:e.localTime||"Unknown"}),(0,a.jsx)("td",{className:"py-2 px-4 truncate max-w-[150px]",title:e.page,children:e.page||"Unknown"}),(0,a.jsx)("td",{className:"py-2 px-4",children:e.location?(0,a.jsx)("span",{children:[e.location.city,e.location.country].filter(Boolean).join(", ")||"Unknown"}):"Unknown"}),(0,a.jsxs)("td",{className:"py-2 px-4",children:[(null==(r=e.browserInfo)?void 0:r.browser)||"Unknown"," ",(null==(i=e.browserInfo)?void 0:i.version)||""]}),s&&(0,a.jsx)("td",{className:"py-2 px-4",children:(null==(l=e.browserInfo)?void 0:l.os)||"Unknown"}),(0,a.jsx)("td",{className:"py-2 px-4",children:(null==(n=e.browserInfo)?void 0:n.mobile)?"Mobile":"Desktop"}),s&&(0,a.jsx)("td",{className:"py-2 px-4 truncate max-w-[150px]",title:e.referrer,children:e.referrer||"Direct"}),!s&&(0,a.jsx)("td",{className:"py-2 px-4",children:(0,a.jsx)(d(),{href:"/admin/visitor/".concat(e.id),className:"text-blue-500 hover:underline",children:"Details"})})]},t)})})]})}),o>1&&(0,a.jsx)("div",{className:"flex justify-center mt-4",children:(0,a.jsxs)("nav",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>h(Math.max(1,l-1)),disabled:1===l,className:"px-3 py-1 rounded-l-md ".concat(1===l?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600"),children:"\xab"}),(0,a.jsx)("div",{className:"flex",children:Array.from({length:o},(e,t)=>t+1).map(e=>(0,a.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 ".concat(l===e?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600"),children:e},e))}),(0,a.jsx)("button",{onClick:()=>h(Math.min(o,l+1)),disabled:l===o,className:"px-3 py-1 rounded-r-md ".concat(l===o?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600"),children:"\xbb"})]})})]})};(0,r.useEffect)(()=>{"overview"===t?M():"statistics"===t?U():"location"===t?z():"visitors"===t&&D()},[t,o,x,u,v]);let M=async()=>{if(!l.v$){f("Firebase Realtime Database is not initialized"),b(!1);return}try{b(!0);let e=0,t=Date.now();"day"===v?e=t-864e5:"week"===v?e=t-6048e5:"month"===v&&(e=t-2592e6);let s=(0,n.KR)(l.v$,"analytics/visitors"),a="all"!==v?(0,n.P)(s,(0,n.kT)("timestamp"),(0,n.EO)(e)):s,r=await (0,n.Jt)(a),i=(0,n.KR)(l.v$,"users"),o=await (0,n.Jt)(i);if(!r.exists()){P({totalVisitors:0,totalPageViews:0,uniqueVisitors:0,countries:0,cities:0,totalUsers:0,registeredUsers:0,anonymousVisitors:0,usersByRole:{},topPages:{},topCountries:{},topCities:{},recentVisitors:[]}),b(!1);return}let c=[],d=new Set,x=new Set,h=new Set,g={},m={},u={};r.forEach(t=>{let s=t.val();if(s.id=t.key,(!s.timestamp||!(s.timestamp<e))&&(!s.page||!s.page.startsWith("/admin"))){var a,r;c.push(s),d.add(s.sessionId),(null==(a=s.location)?void 0:a.country)&&(x.add(s.location.country),m[s.location.country]=(m[s.location.country]||0)+1),(null==(r=s.location)?void 0:r.city)&&(h.add(s.location.city),u[s.location.city]=(u[s.location.city]||0)+1),g[s.page||"unknown"]=(g[s.page||"unknown"]||0)+1}});let p=0,y=0,j={};o.exists()&&o.forEach(e=>{let t=e.val();p++,t.role?j[t.role]=(j[t.role]||0)+1:j.user=(j.user||0)+1});let f=new Set;c.forEach(e=>{e.isAuthenticated&&e.sessionId&&f.add(e.sessionId)}),y=f.size;let N=d.size-y,w=L(g),k=L(m),S=L(u),T=[...c].sort((e,t)=>t.timestamp-e.timestamp).slice(0,10),O=Object.values(g).reduce((e,t)=>e+t,0),V=d.size,C=c.length;P({totalVisitors:C,totalPageViews:O,uniqueVisitors:V,countries:x.size,cities:h.size,totalUsers:p,registeredUsers:y,anonymousVisitors:N,usersByRole:j,topPages:w,topCountries:k,topCities:S,recentVisitors:T}),b(!1)}catch(e){console.error("Error fetching dashboard data:",e),f(e.message||"Failed to load dashboard data"),b(!1)}},U=async()=>{if(!e){f("You must be logged in to view analytics"),b(!1);return}try{b(!0);let e=await (0,h.Xg)(100),t=new Set,s=new Set,a={},r={},i={},o={},c={},d={},x={},g={},m={},u=Array(24).fill(0),p=Array(7).fill(0),y=Array(12).fill(0),j=0,f=e.filter(e=>!e.page||!e.page.startsWith("/admin"));if(f.forEach(e=>{var l,n,h,g,b,f;if(e.sessionId&&t.add(e.sessionId),e.userId&&s.add(e.userId),(null==(l=e.browserInfo)?void 0:l.deviceType)&&(r[e.browserInfo.deviceType]=(r[e.browserInfo.deviceType]||0)+1),(null==(n=e.browserInfo)?void 0:n.browser)&&(i[e.browserInfo.browser]=(i[e.browserInfo.browser]||0)+1),(null==(h=e.browserInfo)?void 0:h.os)&&(o[e.browserInfo.os]=(o[e.browserInfo.os]||0)+1),(null==(g=e.location)?void 0:g.country)&&(c[e.location.country]=(c[e.location.country]||0)+1),(null==(b=e.location)?void 0:b.region)&&(d[e.location.region]=(d[e.location.region]||0)+1),(null==(f=e.location)?void 0:f.city)&&(x[e.location.city]=(x[e.location.city]||0)+1),a[e.page||"unknown"]=(a[e.page||"unknown"]||0)+1,j++,e.referrer&&!e.referrer.includes(window.location.hostname))try{let t=new URL(e.referrer).hostname;m[t]=(m[t]||0)+1}catch(e){}if(e.timestamp){let t=new Date(e.timestamp);u[t.getHours()]++,p[t.getDay()]++,y[t.getMonth()]++}}),l.v$)try{let e=(0,n.KR)(l.v$,"analytics/interactions"),t=(0,n.P)(e,(0,n.$1)(100)),s=await (0,n.Jt)(t),a=0;s.exists()&&s.forEach(e=>{let t=e.val();t.type&&(g[t.type]=(g[t.type]||0)+1,a++)})}catch(e){console.error("Error fetching interactions data:",e)}let v=[];Object.keys(a).length>0&&(v=Object.entries(a).map(e=>{let[t,s]=e;return{page:t,views:s}}).sort((e,t)=>t.views-e.views).slice(0,10));let N=t.size,w=new Set;f.forEach(e=>{e.isAuthenticated&&e.sessionId&&w.add(e.sessionId)});let P=w.size,k=N>0?j/N:0,T=Object.values(g).reduce((e,t)=>e+t,0);S({totalVisitors:f.length,uniqueVisitors:N,registeredUsers:P,anonymousVisitors:N-P,totalPageViews:j,averagePageViewsPerVisitor:k,topPages:v,averageTimeOnSite:120,averageTimePerPage:60,bounceRate:30,deviceTypes:r,browsers:i,operatingSystems:o,countries:c,regions:d,cities:x,totalInteractions:T,interactionsByType:g,visitorsByHour:u,visitorsByDay:p,visitorsByMonth:y,referrers:m,isLoading:!1}),b(!1)}catch(e){console.error("Error fetching statistics data:",e),f(e.message||"Failed to load statistics data"),b(!1)}},z=async()=>{if(!e){f("You must be logged in to view analytics"),b(!1);return}try{b(!0);let e=await (0,h.Xg)(100);C(e);let t={country:{},region:{},city:{},district:{},ward:{},street:{},postalCode:{},timezone:{},isp:{},connectionType:{}};e.forEach(e=>{e.location&&(e.location.country&&(t.country[e.location.country]=(t.country[e.location.country]||0)+1),e.location.region&&(t.region[e.location.region]=(t.region[e.location.region]||0)+1),e.location.city&&(t.city[e.location.city]=(t.city[e.location.city]||0)+1),e.location.district&&(t.district[e.location.district]=(t.district[e.location.district]||0)+1),e.location.ward&&(t.ward[e.location.ward]=(t.ward[e.location.ward]||0)+1),e.location.street&&(t.street[e.location.street]=(t.street[e.location.street]||0)+1),e.location.postalCode&&(t.postalCode[e.location.postalCode]=(t.postalCode[e.location.postalCode]||0)+1),e.location.timezone&&(t.timezone[e.location.timezone]=(t.timezone[e.location.timezone]||0)+1),e.location.isp&&(t.isp[e.location.isp]=(t.isp[e.location.isp]||0)+1),e.location.connectionType&&(t.connectionType[e.location.connectionType]=(t.connectionType[e.location.connectionType]||0)+1))}),O(t),b(!1)}catch(e){console.error("Error fetching location data:",e),f("Failed to load location data"),b(!1)}},D=async()=>{if(!e){f("You must be logged in to view analytics"),b(!1);return}try{b(!0);let e=await (0,h.Xg)(50);C(e);let t={};e.forEach(e=>{let s=e.page||"unknown";s.startsWith("/admin")||(t[s]=(t[s]||0)+1)}),_(t),b(!1)}catch(e){console.error("Error fetching visitors data:",e),f("Failed to load visitors data"),b(!1)}};return y?(0,a.jsxs)("div",{className:"container mx-auto p-6 pt-16",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Analytics Dashboard"}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:(0,a.jsx)("p",{className:"text-center",children:"Đang tải dữ liệu thống k\xea..."})})]}):j?(0,a.jsxs)("div",{className:"container mx-auto p-6 pt-16",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Analytics Dashboard"}),(0,a.jsx)("div",{className:"bg-red-900 rounded-lg p-6 shadow-lg",children:(0,a.jsxs)("p",{className:"text-center",children:["Lỗi: ",j]})})]}):(0,a.jsxs)("div",{className:"container mx-auto p-6 pt-16",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Analytics Dashboard"}),(0,a.jsxs)("div",{className:"flex border-b border-gray-700 mb-6",children:[(0,a.jsx)("button",{className:"py-2 px-4 mr-2 ".concat("overview"===t?"border-b-2 border-blue-500 text-blue-500":"text-gray-400 hover:text-white"),onClick:()=>s("overview"),children:"Overview"}),(0,a.jsx)("button",{className:"py-2 px-4 mr-2 ".concat("statistics"===t?"border-b-2 border-blue-500 text-blue-500":"text-gray-400 hover:text-white"),onClick:()=>s("statistics"),children:"Thống k\xea chi tiết"}),(0,a.jsx)("button",{className:"py-2 px-4 mr-2 ".concat("location"===t?"border-b-2 border-blue-500 text-blue-500":"text-gray-400 hover:text-white"),onClick:()=>s("location"),children:"Location Analytics"}),(0,a.jsx)("button",{className:"py-2 px-4 ".concat("visitors"===t?"border-b-2 border-blue-500 text-blue-500":"text-gray-400 hover:text-white"),onClick:()=>s("visitors"),children:"Recent Visitors"})]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsx)("label",{className:"font-medium",children:"Khoảng thời gian:"}),(0,a.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"bg-gray-700 text-white rounded px-3 py-2",children:[(0,a.jsx)("option",{value:"today",children:"H\xf4m nay"}),(0,a.jsx)("option",{value:"yesterday",children:"H\xf4m qua"}),(0,a.jsx)("option",{value:"last7days",children:"7 ng\xe0y qua"}),(0,a.jsx)("option",{value:"last30days",children:"30 ng\xe0y qua"}),(0,a.jsx)("option",{value:"thisMonth",children:"Th\xe1ng n\xe0y"}),(0,a.jsx)("option",{value:"lastMonth",children:"Th\xe1ng trước"}),(0,a.jsx)("option",{value:"custom",children:"T\xf9y chỉnh"})]}),"custom"===o&&(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)("input",{type:"date",value:x,onChange:e=>m(e.target.value),className:"bg-gray-700 text-white rounded px-3 py-2"}),(0,a.jsx)("span",{children:"đến"}),(0,a.jsx)("input",{type:"date",value:u,onChange:e=>p(e.target.value),className:"bg-gray-700 text-white rounded px-3 py-2"})]})]})}),"overview"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{items:[{title:"Page Views",value:w.totalPageViews},{title:"Unique Visitors",value:w.uniqueVisitors},{title:"Countries",value:w.countries}]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Visitor Breakdown"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Visitor Types"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:w.anonymousVisitors}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Kh\xe1ch kh\xf4ng đăng nhập"})]}),(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:w.registeredUsers}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Người d\xf9ng đ\xe3 đăng nhập"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Phạm vi địa l\xfd"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:w.countries}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Quốc gia"})]}),(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:w.cities}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Th\xe0nh phố"})]})]})]})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Người d\xf9ng theo vai tr\xf2"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:Object.entries(w.usersByRole).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"rounded-lg p-4 text-center ".concat("viewer"===t?"bg-gray-600":"user"===t?"bg-blue-900":"editor"===t?"bg-green-900":"moderator"===t?"bg-yellow-900":"admin"===t||"superadmin"===t?"bg-red-900":"bg-gray-700"),children:[(0,a.jsx)("p",{className:"text-lg font-bold",children:s}),(0,a.jsxs)("p",{className:"text-sm text-gray-300",children:[t.charAt(0).toUpperCase()+t.slice(1),"s"]})]},t)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"C\xe1c trang phổ biến"}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-80",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Trang"}),(0,a.jsx)("th",{className:"text-right py-2 px-4",children:"Lượt xem"})]})}),(0,a.jsx)("tbody",{children:Object.entries(w.topPages).map((e,t)=>{let[s,r]=e;return(0,a.jsxs)("tr",{className:t%2==0?"bg-gray-750":"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"py-2 px-4 truncate max-w-[200px]",title:s,children:s}),(0,a.jsx)("td",{className:"text-right py-2 px-4",children:r})]},s)})})]})})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quốc gia h\xe0ng đầu"}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-80",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Quốc gia"}),(0,a.jsx)("th",{className:"text-right py-2 px-4",children:"Lượt truy cập"})]})}),(0,a.jsx)("tbody",{children:Object.entries(w.topCountries).map((e,t)=>{let[s,r]=e;return(0,a.jsxs)("tr",{className:t%2==0?"bg-gray-750":"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"py-2 px-4",children:s}),(0,a.jsx)("td",{className:"text-right py-2 px-4",children:r})]},s)})})]})})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Người truy cập gần đ\xe2y"}),(0,a.jsx)(R,{visitors:w.recentVisitors,showDetails:!1})]})]}),"statistics"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{items:[{title:"Lượt xem trang",value:k.totalPageViews.toLocaleString()},{title:"Người d\xf9ng duy nhất",value:k.uniqueVisitors.toLocaleString()},{title:"Tỷ lệ tho\xe1t",value:k.bounceRate.toFixed(1)+"%"}]}),(0,a.jsx)(e=>{let{registeredUsers:t,anonymousVisitors:s,averagePageViewsPerVisitor:r}=e;return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Ph\xe2n loại người d\xf9ng"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.toLocaleString()}),(0,a.jsx)("p",{className:"text-gray-400",children:"Người d\xf9ng đ\xe3 đăng k\xfd"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:s.toLocaleString()}),(0,a.jsx)("p",{className:"text-gray-400",children:"Kh\xe1ch kh\xf4ng đăng k\xfd"})]}),void 0!==r&&(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:r.toFixed(1)}),(0,a.jsx)("p",{className:"text-gray-400",children:"Trang/người d\xf9ng"})]})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(g,{options:{labels:["Người d\xf9ng đ\xe3 đăng k\xfd","Kh\xe1ch kh\xf4ng đăng k\xfd"],colors:["#4ade80","#60a5fa"],legend:{position:"bottom",labels:{colors:"#fff"}},dataLabels:{enabled:!0,formatter:function(e){return e.toFixed(1)+"%"}},plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"Tổng",color:"#fff"}}}}}},series:[t,s],type:"donut",height:300})})]})},{registeredUsers:k.registeredUsers,anonymousVisitors:k.anonymousVisitors,averagePageViewsPerVisitor:k.averagePageViewsPerVisitor}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Thống k\xea thời gian"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:I(k.averageTimeOnSite)}),(0,a.jsx)("p",{className:"text-gray-400",children:"Thời gian trung b\xecnh tr\xean trang web"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:I(k.averageTimePerPage)}),(0,a.jsx)("p",{className:"text-gray-400",children:"Thời gian trung b\xecnh tr\xean mỗi trang"})]}),(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 text-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[k.bounceRate.toFixed(1),"%"]}),(0,a.jsx)("p",{className:"text-gray-400",children:"Tỷ lệ tho\xe1t"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Thống k\xea c\xe1c trang"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Tổng lượt xem trang"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:k.totalPageViews.toLocaleString()}),(0,a.jsx)("h3",{className:"text-lg font-medium mt-6 mb-2",children:"C\xe1c trang được xem nhiều nhất"}),(0,a.jsx)(e=>{let{pages:t,totalViews:s,itemsPerPage:i=10}=e,[l,n]=(0,r.useState)(1);if(!Array.isArray(t)&&0===Object.keys(t).length||Array.isArray(t)&&0===t.length||!s)return(0,a.jsx)("div",{className:"text-center py-4 text-gray-400",children:"Kh\xf4ng c\xf3 dữ liệu về lượt xem trang"});let o=[...Array.isArray(t)?t:Object.entries(t).map(e=>{let[t,s]=e;return{page:t,views:s}})].sort((e,t)=>{let s="object"==typeof e?e.views:0;return("object"==typeof t?t.views:0)-s}),c=Math.ceil(o.length/i),d=l*i,x=o.slice(d-i,d),h=e=>n(e);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"overflow-y-auto",children:(0,a.jsxs)("table",{className:"min-w-full bg-gray-700 rounded-lg",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"py-2 px-4 text-left",children:"Trang"}),(0,a.jsx)("th",{className:"py-2 px-4 text-right",children:"Lượt xem"}),(0,a.jsx)("th",{className:"py-2 px-4 text-right",children:"Phần trăm"})]})}),(0,a.jsx)("tbody",{children:x.map((e,r)=>{let i="object"==typeof e?e.page:e,l="object"==typeof e?e.views:t[e];return(0,a.jsxs)("tr",{className:r%2==0?"bg-gray-750":"",children:[(0,a.jsx)("td",{className:"py-2 px-4 truncate max-w-md",children:i||"Unknown"}),(0,a.jsx)("td",{className:"py-2 px-4 text-right",children:l}),(0,a.jsxs)("td",{className:"py-2 px-4 text-right",children:[(l/s*100).toFixed(1),"%"]})]},i||r)})})]})}),c>1&&(0,a.jsx)("div",{className:"flex justify-center mt-4",children:(0,a.jsxs)("nav",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>h(Math.max(1,l-1)),disabled:1===l,className:"px-3 py-1 rounded-l-md ".concat(1===l?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600"),children:"\xab"}),(0,a.jsx)("div",{className:"flex",children:Array.from({length:c},(e,t)=>t+1).map(e=>(0,a.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 ".concat(l===e?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600"),children:e},e))}),(0,a.jsx)("button",{onClick:()=>h(Math.min(c,l+1)),disabled:l===c,className:"px-3 py-1 rounded-r-md ".concat(l===c?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600"),children:"\xbb"})]})})]})},{pages:k.topPages,totalViews:k.totalPageViews})]}),k.topPages&&k.topPages.length>0&&(0,a.jsx)("div",{children:(0,a.jsx)(g,{options:{labels:k.topPages.slice(0,7).map(e=>{let t="object"==typeof e?e.page:Object.keys(e)[0];return t&&t.length>20?t.substring(0,17)+"...":t||"Unknown"}),legend:{position:"bottom",labels:{colors:"#fff"}},dataLabels:{enabled:!0,formatter:function(e){return e.toFixed(1)+"%"}},colors:["#4ade80","#60a5fa","#f472b6","#fbbf24","#a78bfa","#34d399","#fb7185"]},series:k.topPages.slice(0,7).map(e=>"object"==typeof e?e.views:Object.values(e)[0]),type:"pie",height:350})})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Thống k\xea tương t\xe1c"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Tổng số tương t\xe1c"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:k.totalInteractions.toLocaleString()}),(0,a.jsx)("h3",{className:"text-lg font-medium mt-6 mb-2",children:"Tương t\xe1c theo loại"}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-80",children:(0,a.jsxs)("table",{className:"min-w-full bg-gray-700 rounded-lg",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"py-2 px-4 text-left",children:"Loại tương t\xe1c"}),(0,a.jsx)("th",{className:"py-2 px-4 text-right",children:"Số lượng"}),(0,a.jsx)("th",{className:"py-2 px-4 text-right",children:"Phần trăm"})]})}),(0,a.jsx)("tbody",{children:Object.entries(k.interactionsByType).sort((e,t)=>t[1]-e[1]).map((e,t)=>{let[s,r]=e;return(0,a.jsxs)("tr",{className:t%2==0?"bg-gray-750":"",children:[(0,a.jsx)("td",{className:"py-2 px-4",children:s}),(0,a.jsx)("td",{className:"py-2 px-4 text-right",children:r}),(0,a.jsxs)("td",{className:"py-2 px-4 text-right",children:[(r/k.totalInteractions*100).toFixed(1),"%"]})]},s)})})]})})]}),Object.keys(k.interactionsByType).length>0&&(0,a.jsx)("div",{children:(0,a.jsx)(g,{options:{labels:Object.keys(k.interactionsByType).map(e=>e.replace("_"," ").charAt(0).toUpperCase()+e.replace("_"," ").slice(1)),legend:{position:"bottom",labels:{colors:"#fff"}},dataLabels:{enabled:!0,formatter:function(e){return e.toFixed(1)+"%"}},colors:["#4ade80","#60a5fa","#f472b6","#fbbf24","#a78bfa","#34d399","#fb7185"]},series:Object.values(k.interactionsByType),type:"pie",height:350})})]})]})]}),"location"===t&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Timezones"}),(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Timezone"}),(0,a.jsx)("th",{className:"text-right py-2 px-4",children:"Lượt truy cập"}),(0,a.jsx)("th",{className:"text-right py-2 px-4",children:"Phần trăm"})]})}),(0,a.jsx)("tbody",{children:Object.entries(L(T.timezone)).map(e=>{let[t,s]=e;return(0,a.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"py-2 px-4",children:t}),(0,a.jsx)("td",{className:"text-right py-2 px-4",children:s}),(0,a.jsxs)("td",{className:"text-right py-2 px-4",children:[(s/V.length*100).toFixed(1),"%"]})]},t)})})]})]})}),"visitors"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Page Views"}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-4",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-2 px-4",children:"Page"}),(0,a.jsx)("th",{className:"text-right py-2 px-4",children:"Views"})]})}),(0,a.jsx)("tbody",{children:Object.entries(A).map(e=>{let[t,s]=e;return(0,a.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"py-2 px-4",children:t}),(0,a.jsx)("td",{className:"text-right py-2 px-4",children:s})]},t)})})]})})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Recent Visitors (",V.length,")"]}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 overflow-x-auto",children:(0,a.jsx)(R,{visitors:V,showDetails:!0})})]})]})]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,9507,7158,6874,883,283,8441,1684,7358],()=>t(5095)),_N_E=e.O()}]);